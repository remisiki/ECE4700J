\documentclass[12pt]{article}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language
\usepackage[english]{babel}

% Set page size and margins
% Replace `letterpaper' with`a4paper' for UK/EU standard size
% \usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages
\usepackage[margin=2.54cm]{geometry}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{csquotes}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{indentfirst}
\usepackage{enumerate}
\title{ECE4700J Homework 1}
\author{Yiwen Yang}

	
\begin{document}
\date{}
\maketitle

\section*{Q1}

\begin{enumerate}
	\item Since RISC has already proved to overwhelm CISC as time passed, we have entered the post-PC era where improvements on general-purpose processor ISA becomes quite difficult. At this moment, Mooreâ€™s Law and Dennard Scaling both stopped, and we will have to look more on how the computer architecture implements ISA rather than ISA itself. The seemingly bottleneck in fact implies that we have already done very well and should look forward. Current challenge is about the inefficiency and wasted resources on mis-predictions of branches caused by ILP. Limited TDP pushes us to think more about energy saving, and in fact a small optimization in the compiler level may contribute greatly to the efficiency.
	\item So far the industry has focused a lot on performance, but now it is time to think about hardware security. Rather than a correct implementation of ISA, we should design and produce a good implementation, where security is very important. In this era, we have the spare to make some encryptions on hardware level to fix the information leakage and potential vulnerabilities. Many attacks such as side-channel, Meltdown and Spectre are already known to us, which is not bad but instead helpful to figure out and fix problems at an early stage.
	\item As an opportunity for future compiter architecture, we can now design specific-purpose processors to solve certain problems rather than sticking to general-purpose ones. The benefits of DSA and DSL are that complex designs are not necessary and very specific optimizations can be made with less precision yet greatly enhancing the processor performance in the domain, also parallelism problem can be solved partially. There are currently many new calculating hardwares to serve different needs, and the competition between large players will push the whole industry forward just like ISA competition in the last era.
\end{enumerate}

\section*{Q2}

\begin{enumerate}
	\item CISC is more compiler-friendly, since instructions can be microcoded by hardware.
	\item Addressing mode is more compound, such that memory access is more flexible.
\end{enumerate}

\section*{Q3}

CPI is calculated as 
\begin{align*}
	CPI = p_{load}C_{load} + p_{store}C_{store} + p_{ALU}C_{ALU} + p_{branch}C_{branch} + p_{jump}C_{jump}
\end{align*}

Then we can get
\begin{table}[hbtp]
	\centering
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		 & Method & Old CPI & New CPI & Speedup\\
		\hline
		\multirow{2}{*}{sjeng}
		 & 1 & 4.42 & 3.86 & 1.145\\
		\cline{2-5}
		 & 2 & 4.42 & 4.09 & 1.080\\
		\hline
		\multirow{2}{*}{mcf}
		 & 1 & 4.8 & 4.51 & 1.064\\
		\cline{2-5}
		 & 2 & 4.8 & 4.31 & 1.114\\
		\hline 
	\end{tabular}
\end{table}

So \textbf{sjeng} will prefer the first method since it involves a large proportion of ALU operations, and \textbf{mcf} will prefer the second one since ALU speedup does not improve more than branch speedup.

\section*{Q4}

Let $p$ be the percentage that can be enhanced, then
\begin{align*}
	\frac{p}{2.5} + 1 - p &= \frac{1}{1 + 10\%}\\
	p &= 0.152
\end{align*}

So at least $15.2\%$ of the program should be run in enhanced mode.

\section*{Q5}

\begin{enumerate}
	\item 
	\begin{align*}
		t = \frac{1}{f} = 3.70 \times 10^{-10} s
	\end{align*}
	\begin{align*}
		PDP &= P_{avg} \cdot t\\
		&= 3.89 \times 10^{-8} J
	\end{align*}
	\begin{align*}
		EDP &= PDP \cdot t\\
		&= 1.44 \times 10^{-17} J
	\end{align*}
	\begin{align*}
		EDDP &= EDP \cdot t\\
		&= 5.33 \times 10^{-27} J
	\end{align*}
	\item 
	\begin{align*}
		P_{dyn,old} &= 105W \times \frac{3}{4} = 78.75W\\
		\frac{f_{new}}{f_{old}} &= \frac{P_{dyn,new}}{P_{dyn,old}}\\
		&= 1.65\\
		f_{new} &= 1.65 f_{old} = 4.46GHz
	\end{align*}

	So the frequency can be sped up by $65\%$ to 4.46 GHz.
\end{enumerate}

\section*{Q6}

From Bose-Einstein Formula
\begin{align*}
	\text{Die yield} &= \text{Wafer yield} \times 1/(1+\text{Defects per unit area} \times \text{Die area})^{\alpha}\\
	&= 99\% \times 1/(1+0.016 \times 2.4)^{10}\\
	&= 99\%
\end{align*}

Then
\begin{align*}
	\text{Dies per wafer} &= \frac{\pi \times (\text{Wafer diameter}/2)^2}{\text{Die area}}
		- \frac{\pi \times \text{Wafer diameter}}{\sqrt{2\times \text{Die area}}}\\
	&= \frac{\pi \times (42/2)^2}{2.4}
		- \frac{\pi \times 42}{\sqrt{2\times 2.4}}\\
	&= 517
\end{align*}
\begin{align*}
	\text{Cost of die} &= \frac{\text{Cost of wafer}}{\text{Dies per wafer} \times \text{Die yield}}\\
	&= \frac{9000}{517 \times 99\%}\\
	&= 17.58
\end{align*}

So expected cost of die is \$17.58.

\section*{Q7}

\begin{align*}
	S_{opt} &= \sqrt{\frac{(1-b)T}{bC}}\\
	&= \sqrt{\frac{(1-0.2)\times \frac{1}{700\times 10^{6}} \times (1+5\%)}{0.2 \times 500\times 10^{-12}}}\\
	&= 3.5
\end{align*}
\begin{align*}
	f_{new} = 3.5 \times 700MHz = 2.45GHz
\end{align*}
\begin{align*}
	G &= (\frac{1}{1+(S-1)b})\times(\frac{1}{(T/S)+C})\\
	&= (\frac{1}{1+(3.5-1)\times 0.2})\times(\frac{1}{(1.5\times 10^{-9}/3.5)+500\times 10^{-12}})\\
	&= 7.18 \times 10^8
\end{align*}

So the optimal number of stages is 3.5, clock frequency is 2.45 GHz, throughput is $7.18 \times 10^8$.

\section*{Q8}

\begin{enumerate}[1)]
	\item 2 $\rightarrow$ 4 (RAW)
	\item 3 $\rightarrow$ 4 (RAW)
	\item 4 $\rightarrow$ 5 (RAW, WAR)
	\item 7 $\rightarrow$ 1 (WAR)
\end{enumerate}

\section*{Q9}

\begin{enumerate}
	\item With more registers, the length of each instruction also has to be extended to address them.
	\item The register file will have greater latency as the register number grows large, so that datapath and clock cycle will be longer.
	\item Registers are expensive and consume much energy, having more registers means an increase in both heat and cost.
\end{enumerate}

\end{document}
